---
title: ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜
typora-root-url: ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜
mathjax: true
date: 2025-06-14 13:06:01
tags:
    - å®è·µ
    - LeetCode
categories: 
  - ç»å…¸é˜Ÿåˆ—/æ ˆç®—æ³•
  - ç®—æ³•
  - æ•°æ®ç»“æ„
---

## [å•è°ƒæ ˆæ¨¡æ¿çš„å˜ä½“](https://labuladong.online/algo/problem-set/monotonic-stack/#å•è°ƒæ ˆæ¨¡æ¿çš„å˜ä½“)

### [ä¸‹ä¸€ä¸ªæ›´å¤§çš„å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸‹ä¸€ä¸ªæ›´å¤§çš„å…ƒç´ )

ä¸Šç¯‡æ–‡ç«  [å•è°ƒæ ˆçš„å®ç°](https://labuladong.online/algo/data-structure/monotonic-stack/) å¸¦ä½ ä½¿ç”¨å•è°ƒæ ˆè§£å†³äº†ã€Œä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ã€çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

``` java
è¾“å…¥ï¼šnums = [1, 3, 2, 4, 4]
è¿”å›ï¼šres = [3, 4, 4, -1, -1]
```

æˆ‘ä»¬å®ç°äº†è¿™æ ·ä¸€ä¸ªå‡½æ•°è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ 
int[] nextGreaterElement(int[] nums) {
    int n = nums.length;
    // å­˜æ”¾ç­”æ¡ˆçš„æ•°ç»„
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>(); 
    // å› ä¸ºæ˜¯æ±‚ nums[i] åé¢çš„å…ƒç´ ï¼Œæ‰€ä»¥å€’ç€å¾€æ ˆé‡Œæ”¾
    for (int i = n - 1; i >= 0; i--) {
        // åˆ æ‰ nums[i] åé¢è¾ƒå°çš„å…ƒç´ 
        while (!stk.isEmpty() && stk.peek() <= nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] èº«åçš„æ›´å¤§å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

### [ä¸‹ä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰çš„å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸‹ä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰çš„å…ƒç´ )

æœ¬æ–‡ç»™å‡ºè¿™ä¸ªé—®é¢˜çš„ä¸€äº›å˜ä½“ï¼Œæ¯”å¦‚è¯´è®©ä½ è®¡ç®— `nums[i]` çš„ä¸‹ä¸€ä¸ªå¤§äºç­‰äº `nums[i]` çš„å…ƒç´ æ€ä¹ˆç®—ï¼Ÿæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

``` java
è¾“å…¥ï¼šnums = [1, 3, 2, 4, 4]
è¿”å›ï¼šres = [3, 4, 4, 4, -1]
```

å…¶å®å¾ˆç®€å•ï¼ŒæŠŠä¸Šé¢è¿™æ®µä»£ç ä¸­ while å¾ªç¯çš„ `<=` å·æ”¹æˆ `<` å·å³å¯ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰çš„å…ƒç´ 
int[] nextGreaterOrEqualElement(int[] nums) {
    int n = nums.length;
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>(); 
    for (int i = n - 1; i >= 0; i--) {
        // æŠŠè¿™é‡Œæ”¹æˆ < å·
        while (!stk.isEmpty() && stk.peek() < nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] èº«åçš„å¤§äºç­‰äº nums[i] çš„å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

### [ä¸‹ä¸€ä¸ªæ›´å°çš„å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸‹ä¸€ä¸ªæ›´å°çš„å…ƒç´ )

å†å˜ä¸€å˜ï¼Œå¦‚æœè®©ä½ è®¡ç®— `nums[i]` çš„ä¸‹ä¸€ä¸ªå°äº `nums[i]` çš„å…ƒç´ ï¼Œæ€ä¹ˆç®—ï¼Ÿæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

``` java
è¾“å…¥ï¼šnums = [8, 4, 6, 6, 3]
è¿”å›ï¼šres = [4, 3, 3, 3, -1]
```

ä¹Ÿå¾ˆç®€å•ï¼ŒæŠŠä¹‹å‰å®ç°çš„ `nextGreaterElement` ä¸­ while å¾ªç¯çš„ `<=` æ¡ä»¶æ”¹æˆ `>=` æ¡ä»¶å³å¯å¾—å‡ºä¸‹ä¸€ä¸ªæ›´å°çš„å…ƒç´ ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªæ›´å°çš„å…ƒç´ 
int[] nextLessElement(int[] nums) {
    int n = nums.length;
    // å­˜æ”¾ç­”æ¡ˆçš„æ•°ç»„
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>(); 
    // å€’ç€å¾€æ ˆé‡Œæ”¾
    for (int i = n - 1; i >= 0; i--) {
        // åˆ æ‰ nums[i] åé¢è¾ƒå¤§çš„å…ƒç´ 
        while (!stk.isEmpty() && stk.peek() >= nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] èº«åçš„æ›´å°å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

### [ä¸‹ä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸‹ä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ )

å¦‚æœè®©ä½ è®¡ç®— `nums[i]` çš„ä¸‹ä¸€ä¸ªå°äºæˆ–ç­‰äº `nums[i]` çš„å…ƒç´ ï¼Œæ€ä¹ˆç®—ï¼Ÿæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

``` java
è¾“å…¥ï¼šnums = [8, 4, 6, 6, 3]
è¿”å›ï¼šres = [4, 3, 6, 3, -1]
```

ç±»ä¼¼çš„ï¼ŒæŠŠ `nextLessElement` å‡½æ•°çš„ while å¾ªç¯ä¸­çš„ `>=` æ”¹æˆ `>` å³å¯ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ 
int[] nextLessOrEqualElement(int[] nums) {
    int n = nums.length;
    // å­˜æ”¾ç­”æ¡ˆçš„æ•°ç»„
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>();
    // å€’ç€å¾€æ ˆé‡Œæ”¾
    for (int i = n - 1; i >= 0; i--) {
        // åˆ æ‰ nums[i] åé¢è¾ƒå¤§çš„å…ƒç´ 
        while (!stk.isEmpty() && stk.peek() > nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] èº«åçš„æ›´å°æˆ–ç›¸ç­‰å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

### [ä¸Šä¸€ä¸ªæ›´å¤§å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸Šä¸€ä¸ªæ›´å¤§å…ƒç´ )

ä¹‹å‰çš„ 4 ä¸ªä¾‹å­éƒ½æ˜¯è®¡ç®— `nums[i]` çš„ä¸‹ä¸€ä¸ªæ›´å¤§/æ›´å°å…ƒç´ ï¼Œç°åœ¨è¯·ä½ è®¡ç®— `nums[i]` çš„ä¸Šä¸€ä¸ªæ›´å¤§å…ƒç´ ï¼Œä½ ä¼šä¸ä¼šï¼Ÿæ¯”å¦‚è¿™ä¸ªä¾‹å­ï¼š

``` java
è¾“å…¥ï¼šnums = [8, 7, 6, 7]
è¿”å›ï¼šres = [-1, 8, 7, 8]
```

æ³¨æ„ä¹‹å‰æˆ‘ä»¬çš„ for å¾ªç¯éƒ½æ˜¯ä»æ•°ç»„çš„å°¾éƒ¨å¼€å§‹å¾€æ ˆé‡Œæ·»åŠ å…ƒç´ ï¼Œè¿™æ ·æ ˆé¡¶å…ƒç´ å°±æ˜¯ `nums[i]` ä¹‹åçš„å…ƒç´ ã€‚æ‰€ä»¥åªè¦æˆ‘ä»¬ä»æ•°ç»„çš„å¤´éƒ¨å¼€å§‹å¾€æ ˆé‡Œæ·»åŠ å…ƒç´ ï¼Œæ ˆé¡¶çš„å…ƒç´ å°±æ˜¯ `nums[i]` ä¹‹å‰çš„å…ƒç´ ï¼Œå³å¯è®¡ç®— `nums[i]` çš„ä¸Šä¸€ä¸ªæ›´å¤§å…ƒç´ ã€‚

ä»£ç å®ç°å¦‚ä¸‹ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸Šä¸€ä¸ªæ›´å¤§å…ƒç´ 
int[] prevGreaterElement(int[] nums) {
    int n = nums.length;
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>(); 
    // å› ä¸ºæ˜¯æ±‚ nums[i] å‰é¢çš„å…ƒç´ ï¼Œæ‰€ä»¥æ­£ç€å¾€æ ˆé‡Œæ”¾
    for (int i = 0; i < n; i++) {
        // åˆ æ‰ nums[i] å‰é¢è¾ƒå°çš„å…ƒç´ 
        while (!stk.isEmpty() && stk.peek() <= nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] å‰é¢çš„æ›´å¤§å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

ç±»ä¼¼ä¹‹å‰çš„å‡ ç§å®ç°ï¼ŒåŸºäºè¿™ä¸ªå‡½æ•°è¿˜å¯ä»¥æ±‚å‡º `nums[i]` çš„ä¸Šä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰çš„å…ƒç´ ã€ä¸Šä¸€ä¸ªæ›´å°çš„å…ƒç´ ã€ä¸Šä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ ï¼Œåªè¦æ”¹ä¸€æ”¹ while å¾ªç¯çš„ç¬¦å·å³å¯ï¼Œä¸‹é¢ä¸€ä¸€åˆ—å‡ºå…·ä½“å®ç°ã€‚

### [ä¸Šä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰çš„å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸Šä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰çš„å…ƒç´ )

ä¸¾ä¾‹ï¼š

``` java
è¾“å…¥ï¼šnums = [8, 7, 6, 7]
è¿”å›ï¼šres = [-1, 8, 7, 8]
```

ä»£ç å®ç°ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸Šä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰å…ƒç´ 
int[] prevGreaterOrEqualElement(int[] nums) {
    int n = nums.length;
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>(); 
    for (int i = 0; i < n; i++) {
        // æ³¨æ„ä¸ç­‰å·
        while (!stk.isEmpty() && stk.peek() < nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] å‰é¢çš„æ›´å¤§æˆ–ç›¸ç­‰å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

### [ä¸Šä¸€ä¸ªæ›´å°çš„å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸Šä¸€ä¸ªæ›´å°çš„å…ƒç´ )

ä¸¾ä¾‹ï¼š

``` java
è¾“å…¥ï¼šnums = [3, 6, 6, 5]
è¿”å›ï¼šres = [-1, 3, 3, 3]
```

ä»£ç å®ç°ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸Šä¸€ä¸ªæ›´å°çš„å…ƒç´ 
int[] prevLessElement(int[] nums) {
    int n = nums.length;
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>(); 
    for (int i = 0; i < n; i++) {
        // æŠŠ nums[i] ä¹‹å‰çš„è¾ƒå¤§å…ƒç´ åˆ é™¤
        while (!stk.isEmpty() && stk.peek() >= nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] å‰é¢çš„æ›´å°å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

### [ä¸Šä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ ](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¸Šä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ )

ä¸¾ä¾‹ï¼š

``` java
è¾“å…¥ï¼šnums = [3, 6, 6, 5]
è¿”å›ï¼šres = [-1, 3, 6, 3]
```

ä»£ç å®ç°ï¼š

``` java
// è®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸Šä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰å…ƒç´ 
int[] prevLessOrEqualElement(int[] nums) {
    int n = nums.length;
    int[] res = new int[n];
    Stack<Integer> stk = new Stack<>(); 
    for (int i = 0; i < n; i++) {
        // æ³¨æ„ä¸ç­‰å·
        while (!stk.isEmpty() && stk.peek() > nums[i]) {
            stk.pop();
        }
        // ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] å‰é¢çš„æ›´å°æˆ–ç›¸ç­‰å…ƒç´ 
        res[i] = stk.isEmpty() ? -1 : stk.peek();
        stk.push(nums[i]);
    }
    return res;
}
```

**è‡³æ­¤ï¼Œå•è°ƒæ ˆçš„å‡ ç§æ ‡å‡†æ¨¡æ¿å°±åˆ—ä¸¾å®Œäº†ï¼Œä»–ä»¬ä¹‹é—´æœ‰å¾ˆå¤šå…±æ€§ï¼Œç†è§£æ€§è®°å¿†å°±å¥½ï¼Œä¸ç”¨æ­»è®°ç¡¬èƒŒã€‚åœ¨å®é™…ç®—æ³•é¢˜ä¸­ä¸ä¼šç›´æ¥è€ƒå¯Ÿä½ è¿™äº›æ ‡å‡†åœºæ™¯ï¼Œä½†æ˜¯ç¨åŠ æ€è€ƒå°±å¯ä»¥æŠ½è±¡æˆè¿™äº›æ ‡å‡†åœºæ™¯**ã€‚

ä¸‹é¢å¸¦å¤§å®¶åšå‡ é“ä¹ é¢˜ç»ƒä¹ ä¸€ä¸‹å•è°ƒæ ˆæ¨¡æ¿çš„ä½¿ç”¨ã€‚

## [ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/#ä¹ é¢˜)

## [1019. é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªæ›´å¤§èŠ‚ç‚¹](https://labuladong.online/algo/problem-set/monotonic-stack/#slug_next-greater-node-in-linked-list)

<details class="hint-container details" open="" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1.25rem 1rem; border-radius: 0.5rem; color: rgb(60, 60, 67); font-family: Inter, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="position: relative; margin: -1rem -1rem 0.5em; padding-block: 1em; padding-inline: 3em 1.5em; list-style: none; font-size: 16px; cursor: pointer;"><strong style="font-weight: 600;">1019. é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªæ›´å¤§èŠ‚ç‚¹</strong>&nbsp;|<span>&nbsp;</span><span><a href="https://leetcode.cn/problems/next-greater-node-in-linked-list/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£</a><span>&nbsp;</span>|<span>&nbsp;</span></span><span><a href="https://leetcode.com/problems/next-greater-node-in-linked-list/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">LeetCode</a><span>&nbsp;</span>|</span><span>&nbsp;</span>&nbsp;ğŸŸ </summary><div><p style="line-height: 1.6; overflow-wrap: break-word;">ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n</code>&nbsp;çš„é“¾è¡¨&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">head</code></p><p style="line-height: 1.6; overflow-wrap: break-word;">å¯¹äºåˆ—è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾ä¸‹ä¸€ä¸ª<span>&nbsp;</span><strong style="font-weight: 600;">æ›´å¤§èŠ‚ç‚¹</strong><span>&nbsp;</span>çš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæ‰¾åˆ°å®ƒæ—è¾¹çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„å€¼<span>&nbsp;</span><strong style="font-weight: 600;">ä¸¥æ ¼å¤§äº</strong><span>&nbsp;</span>å®ƒçš„å€¼ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">è¿”å›ä¸€ä¸ªæ•´æ•°æ•°ç»„<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">answer</code><span>&nbsp;</span>ï¼Œå…¶ä¸­<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">answer[i]</code><span>&nbsp;</span>æ˜¯ç¬¬<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code><span>&nbsp;</span>ä¸ªèŠ‚ç‚¹(<span>&nbsp;</span><strong style="font-weight: 600;">ä»1å¼€å§‹</strong><span>&nbsp;</span>)çš„ä¸‹ä¸€ä¸ªæ›´å¤§çš„èŠ‚ç‚¹çš„å€¼ã€‚å¦‚æœç¬¬<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code><span>&nbsp;</span>ä¸ªèŠ‚ç‚¹æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§çš„èŠ‚ç‚¹ï¼Œè®¾ç½®&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">answer[i] = 0</code>&nbsp;ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 1ï¼š</strong></p><p style="line-height: 1.6; overflow-wrap: break-word;"><img src="https://labuladong.online/algo/images/lc/uploads/2021/08/05/linkedlistnext1.jpg" style="max-width: 100%;"></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>head = [2,1,5]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>[5,5,0]
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 2ï¼š</strong></p><p style="line-height: 1.6; overflow-wrap: break-word;"><img src="https://labuladong.online/algo/images/lc/uploads/2021/08/05/linkedlistnext2.jpg" style="max-width: 100%;"></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>head = [2,7,4,3,5]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>[7,0,5,5,0]
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">æç¤ºï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li>é“¾è¡¨ä¸­èŠ‚ç‚¹æ•°ä¸º&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n</code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= n &lt;= 10<sup>4</sup></code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= Node.val &lt;= 10<sup>9</sup></code></li></ul></div><strong style="font-weight: 600; font-size: small;">é¢˜ç›®æ¥æºï¼š<a href="https://leetcode.cn/problems/next-greater-node-in-linked-list/" class="" target="_blank" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£ 1019. é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªæ›´å¤§èŠ‚ç‚¹</a>ã€‚</strong></details>

### [åŸºæœ¬æ€è·¯](https://labuladong.online/algo/problem-set/monotonic-stack/#åŸºæœ¬æ€è·¯)

è¿™é“é¢˜è¾“å…¥çš„æ˜¯ä¸€æ¡å•é“¾è¡¨ï¼Œæˆ‘ä»¬æŠŠå®ƒè½¬åŒ–æˆæ•°ç»„ï¼Œæ–¹ä¾¿ç”¨ç´¢å¼•è®¿é—®å³å¯ç›´æ¥å¥—ç”¨ [å•è°ƒæ ˆæ¨¡æ¿](https://labuladong.online/algo/data-structure/monotonic-stack/) ä¸­çš„ `nextGreaterElement` å‡½æ•°é€»è¾‘ã€‚

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/)

### [è§£æ³•ä»£ç ](https://labuladong.online/algo/problem-set/monotonic-stack/#è§£æ³•ä»£ç )


``` PYTHON
class Solution:
    def nextLargerNodes(self, head: ListNode) -> List[int]:
        # æŠŠå•é“¾è¡¨è½¬åŒ–æˆæ•°ç»„ï¼Œæ–¹ä¾¿é€šè¿‡ç´¢å¼•è®¿é—®
        nums = []
        p = head
        while p:
            nums.append(p.val)
            p = p.next
        
        # å­˜æ”¾ç­”æ¡ˆçš„æ•°ç»„
        res = [0] * len(nums)
        stk = []
        
        # å•è°ƒæ ˆæ¨¡æ¿ï¼Œæ±‚ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ï¼Œä»åå¾€å‰éå†
        for i in range(len(nums) - 1, -1, -1):
            while stk and stk[-1] <= nums[i]:
                stk.pop()
            # æœ¬é¢˜è¦æ±‚æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ æ—¶è¿”å› 0
            res[i] = 0 if not stk else stk[-1]
            stk.append(nums[i])
        
        return res
```

### [å¯è§†åŒ–](https://labuladong.online/algo/problem-set/monotonic-stack/#å¯è§†åŒ–)

<details data-v-ee1a9bd0="" id="div_next-greater-node-in-linked-list" class="hint-container details" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1rem 0px 0px; border-radius: 0.5rem; margin: 1.3em 0px;"><summary data-v-ee1a9bd0="" style="position: relative; margin: -1rem 0px 0px; padding-block: 1em; padding-inline: 2.3em 1.5em; list-style: none; font-size: large; cursor: pointer; display: flex; align-items: center;"><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="m4.415 18.167l7.17-7.17l1.414 1.414l-7.17 7.17z" opacity="0.3"></path><path data-v-ee1a9bd0="" fill="currentColor" d="m20 7l.94-2.06L23 4l-2.06-.94L20 1l-.94 2.06L17 4l2.06.94zM8.5 7l.94-2.06L11.5 4l-2.06-.94L8.5 1l-.94 2.06L5.5 4l2.06.94zM20 12.5l-.94 2.06l-2.06.94l2.06.94l.94 2.06l.94-2.06L23 15.5l-2.06-.94zm-2.29-3.38l-2.83-2.83c-.2-.19-.45-.29-.71-.29s-.51.1-.71.29L2.29 17.46a.996.996 0 0 0 0 1.41l2.83 2.83c.2.2.45.3.71.3s.51-.1.71-.29l11.17-11.17c.39-.39.39-1.03 0-1.42M5.83 19.59l-1.41-1.41L11.59 11L13 12.41zM14.41 11L13 9.59l1.17-1.17l1.41 1.41z"></path></svg>&nbsp;<strong data-v-ee1a9bd0="" style="font-weight: 600;">ç®—æ³•å¯è§†åŒ–é¢æ¿</strong><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" style="margin-left: auto; margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M20 20v1h1v-1zm-4.293-5.707a1 1 0 0 0-1.414 1.414zM19 14v6h2v-6zm1 5h-6v2h6zm.707.293l-5-5l-1.414 1.414l5 5zM4 20H3v1h1zm5.707-4.293a1 1 0 0 0-1.414-1.414zM3 14v6h2v-6zm1 7h6v-2H4zm.707-.293l5-5l-1.414-1.414l-5 5zM20 4h1V3h-1zm-5.707 4.293a1 1 0 0 0 1.414 1.414zM21 10V4h-2v6zm-1-7h-6v2h6zm-.707.293l-5 5l1.414 1.414l5-5zM4 4V3H3v1zm4.293 5.707a1 1 0 0 0 1.414-1.414zM5 10V4H3v6zM4 5h6V3H4zm-.707-.293l5 5l1.414-1.414l-5-5z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" style="margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M17.65 6.35a7.95 7.95 0 0 0-6.48-2.31c-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20a7.98 7.98 0 0 0 7.21-4.56c.32-.67-.16-1.44-.9-1.44c-.37 0-.72.2-.88.53a5.994 5.994 0 0 1-6.8 3.31c-2.22-.49-4.01-2.3-4.48-4.52A6.002 6.002 0 0 1 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"></path></svg></summary><div data-v-ee1a9bd0="" class="resizable" style="width: 780px; max-width: 100%; height: 70vh; min-height: 500px; overflow: hidden; resize: both;"><iframe data-v-ee1a9bd0="" title="algo-visualize panel" allow="clipboard-write; fullscreen;" id="iframe_next-greater-node-in-linked-list" src="https://labuladong.online/algo-visualize/leetcode/next-greater-node-in-linked-list/" width="100%" height="100%" loading="lazy" scrolling="auto" frameborder="0" style="overflow: auto;"></iframe></div></details>

## [1944. é˜Ÿåˆ—ä¸­å¯ä»¥çœ‹åˆ°çš„äººæ•°](https://labuladong.online/algo/problem-set/monotonic-stack/#slug_number-of-visible-people-in-a-queue)

<details class="hint-container details" open="" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1.25rem 1rem; border-radius: 0.5rem; color: rgb(60, 60, 67); font-family: Inter, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="position: relative; margin: -1rem -1rem 0.5em; padding-block: 1em; padding-inline: 3em 1.5em; list-style: none; font-size: 16px; cursor: pointer;"><strong style="font-weight: 600;">1944. é˜Ÿåˆ—ä¸­å¯ä»¥çœ‹åˆ°çš„äººæ•°</strong>&nbsp;|<span>&nbsp;</span><span><a href="https://leetcode.cn/problems/number-of-visible-people-in-a-queue/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£</a><span>&nbsp;</span>|<span>&nbsp;</span></span><span><a href="https://leetcode.com/problems/number-of-visible-people-in-a-queue/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">LeetCode</a><span>&nbsp;</span>|</span><span>&nbsp;</span>&nbsp;ğŸ”´</summary><div><p style="line-height: 1.6; overflow-wrap: break-word;">æœ‰&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n</code>&nbsp;ä¸ªäººæ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œ<strong style="font-weight: 600;">ä»å·¦åˆ°å³</strong>&nbsp;ç¼–å·ä¸º&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">0</code>&nbsp;åˆ°&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n - 1</code>&nbsp;ã€‚ç»™ä½ ä»¥ä¸€ä¸ªæ•´æ•°æ•°ç»„&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">heights</code>&nbsp;ï¼Œæ¯ä¸ªæ•´æ•°<span>&nbsp;</span><strong style="font-weight: 600;">äº’ä¸ç›¸åŒ</strong>ï¼Œ<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">heights[i]</code>&nbsp;è¡¨ç¤ºç¬¬&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code>&nbsp;ä¸ªäººçš„é«˜åº¦ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">ä¸€ä¸ªäººèƒ½<span>&nbsp;</span><strong style="font-weight: 600;">çœ‹åˆ°</strong><span>&nbsp;</span>ä»–å³è¾¹å¦ä¸€ä¸ªäººçš„æ¡ä»¶æ˜¯è¿™ä¸¤äººä¹‹é—´çš„æ‰€æœ‰äººéƒ½æ¯”ä»–ä»¬ä¸¤äºº<span>&nbsp;</span><strong style="font-weight: 600;">çŸ®</strong>&nbsp;ã€‚æ›´æ­£å¼çš„ï¼Œç¬¬&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code>&nbsp;ä¸ªäººèƒ½çœ‹åˆ°ç¬¬&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">j</code>&nbsp;ä¸ªäººçš„æ¡ä»¶æ˜¯&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i &lt; j</code>&nbsp;ä¸”&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">min(heights[i], heights[j]) &gt; max(heights[i+1], heights[i+2], ..., heights[j-1])</code>&nbsp;ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">è¯·ä½ è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n</code>&nbsp;çš„æ•°ç»„<em>&nbsp;</em><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">answer</code><em>&nbsp;</em>ï¼Œå…¶ä¸­<em>&nbsp;</em><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">answer[i]</code><em>&nbsp;</em>æ˜¯ç¬¬&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code>&nbsp;ä¸ªäººåœ¨ä»–å³ä¾§é˜Ÿåˆ—ä¸­èƒ½&nbsp;<strong style="font-weight: 600;">çœ‹åˆ°</strong>&nbsp;çš„&nbsp;<strong style="font-weight: 600;">äººæ•°</strong>&nbsp;ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 1ï¼š</strong></p><p style="line-height: 1.6; overflow-wrap: break-word;"><img alt="" src="https://labuladong.online/algo/images/lc/uploads/2021/05/29/queue-plane.jpg" style="max-width: 100%; width: 600px; height: 247px;"></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><b>è¾“å…¥ï¼š</b>heights = [10,6,8,5,11,9]
<b>è¾“å‡ºï¼š</b>[3,1,2,1,1,0]
<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>
ç¬¬ 0 ä¸ªäººèƒ½çœ‹åˆ°ç¼–å·ä¸º 1 ï¼Œ2 å’Œ 4 çš„äººã€‚
ç¬¬ 1 ä¸ªäººèƒ½çœ‹åˆ°ç¼–å·ä¸º 2 çš„äººã€‚
ç¬¬ 2 ä¸ªäººèƒ½çœ‹åˆ°ç¼–å·ä¸º 3 å’Œ 4 çš„äººã€‚
ç¬¬ 3 ä¸ªäººèƒ½çœ‹åˆ°ç¼–å·ä¸º 4 çš„äººã€‚
ç¬¬ 4 ä¸ªäººèƒ½çœ‹åˆ°ç¼–å·ä¸º 5 çš„äººã€‚
ç¬¬ 5 ä¸ªäººè°ä¹Ÿçœ‹ä¸åˆ°å› ä¸ºä»–å³è¾¹æ²¡äººã€‚
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 2ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><b>è¾“å…¥ï¼š</b>heights = [5,1,2,3,10]
<b>è¾“å‡ºï¼š</b>[4,1,1,1,0]
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">æç¤ºï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n == heights.length</code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= n &lt;= 10<sup>5</sup></code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= heights[i] &lt;= 10<sup>5</sup></code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">heights</code>&nbsp;ä¸­æ‰€æœ‰æ•°<span>&nbsp;</span><strong style="font-weight: 600;">äº’ä¸ç›¸åŒ</strong>&nbsp;ã€‚</li></ul></div><strong style="font-weight: 600; font-size: small;">é¢˜ç›®æ¥æºï¼š<a href="https://leetcode.cn/problems/number-of-visible-people-in-a-queue/" class="" target="_blank" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£ 1944. é˜Ÿåˆ—ä¸­å¯ä»¥çœ‹åˆ°çš„äººæ•°</a>ã€‚</strong></details>

### [åŸºæœ¬æ€è·¯](https://labuladong.online/algo/problem-set/monotonic-stack/#åŸºæœ¬æ€è·¯-1)

è¿™é“é¢˜æ˜¾ç„¶è¦ç”¨åˆ° [å•è°ƒæ ˆæŠ€å·§](https://labuladong.online/algo/data-structure/monotonic-stack/)ï¼šé å·¦çš„é«˜ä¸ªå­å¯ä»¥æŠŠé å³ç›¸é‚»çš„çŸ®ä¸ªå­éƒ½ã€ŒæŒ¤æ‰ã€ï¼Œç›¸å½“äºè®¡ç®—ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ï¼Œå³ [å•è°ƒæ ˆçš„å‡ ç§æ¨¡æ¿å®ç°](https://labuladong.online/algo/problem-set/monotonic-stack/) ä¸­çš„ `nextGreaterElement` å‡½æ•°ã€‚

åªä¸è¿‡è¿™é“é¢˜ä¸æ˜¯é—®ä½ ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ æ˜¯å¤šå°‘ï¼Œè€Œæ˜¯é—®ä½ å½“å‰å…ƒç´ å’Œä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ä¹‹é—´çš„å…ƒç´ ä¸ªæ•°ï¼Œç›´æ¥çœ‹è§£æ³•ä»£ç å§ã€‚

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/)

### [è§£æ³•ä»£ç ](https://labuladong.online/algo/problem-set/monotonic-stack/#è§£æ³•ä»£ç -1)


``` python
class Solution:
    def canSeePersonsCount(self, heights):
        n = len(heights)
        res = [0] * n
        # int[] è®°å½• {èº«é«˜ï¼Œå°äºç­‰äºè¯¥èº«é«˜çš„äººæ•°} äºŒå…ƒç»„
        stk = []
        for i in range(n - 1, -1, -1):
            # è®°å½•å³ä¾§æ¯”è‡ªå·±çŸ®çš„äºº
            count = 0
            # å•è°ƒæ ˆæ¨¡æ¿ï¼Œè®¡ç®—ä¸‹ä¸€ä¸ªæ›´å¤§æˆ–ç›¸ç­‰å…ƒç´ ï¼ˆèº«é«˜ï¼‰
            while stk and heights[i] > stk[-1]:
                stk.pop()
                count += 1
            # ä¸ä»…å¯ä»¥çœ‹åˆ°æ¯”è‡ªå·±çŸ®çš„äººï¼Œå¦‚æœåé¢å­˜åœ¨æ›´é«˜çš„çš„äººï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°è¿™ä¸ªé«˜äºº
            res[i] = count if not stk else count + 1
            stk.append(heights[i])
        return res
```

### [å¯è§†åŒ–](https://labuladong.online/algo/problem-set/monotonic-stack/#å¯è§†åŒ–-1)

<details data-v-ee1a9bd0="" id="div_number-of-visible-people-in-a-queue" class="hint-container details" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1rem 0px 0px; border-radius: 0.5rem; margin: 1.3em 0px;"><summary data-v-ee1a9bd0="" style="position: relative; margin: -1rem 0px 0px; padding-block: 1em; padding-inline: 2.3em 1.5em; list-style: none; font-size: large; cursor: pointer; display: flex; align-items: center;"><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="m4.415 18.167l7.17-7.17l1.414 1.414l-7.17 7.17z" opacity="0.3"></path><path data-v-ee1a9bd0="" fill="currentColor" d="m20 7l.94-2.06L23 4l-2.06-.94L20 1l-.94 2.06L17 4l2.06.94zM8.5 7l.94-2.06L11.5 4l-2.06-.94L8.5 1l-.94 2.06L5.5 4l2.06.94zM20 12.5l-.94 2.06l-2.06.94l2.06.94l.94 2.06l.94-2.06L23 15.5l-2.06-.94zm-2.29-3.38l-2.83-2.83c-.2-.19-.45-.29-.71-.29s-.51.1-.71.29L2.29 17.46a.996.996 0 0 0 0 1.41l2.83 2.83c.2.2.45.3.71.3s.51-.1.71-.29l11.17-11.17c.39-.39.39-1.03 0-1.42M5.83 19.59l-1.41-1.41L11.59 11L13 12.41zM14.41 11L13 9.59l1.17-1.17l1.41 1.41z"></path></svg>&nbsp;<strong data-v-ee1a9bd0="" style="font-weight: 600;">ç®—æ³•å¯è§†åŒ–é¢æ¿</strong><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" style="margin-left: auto; margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M20 20v1h1v-1zm-4.293-5.707a1 1 0 0 0-1.414 1.414zM19 14v6h2v-6zm1 5h-6v2h6zm.707.293l-5-5l-1.414 1.414l5 5zM4 20H3v1h1zm5.707-4.293a1 1 0 0 0-1.414-1.414zM3 14v6h2v-6zm1 7h6v-2H4zm.707-.293l5-5l-1.414-1.414l-5 5zM20 4h1V3h-1zm-5.707 4.293a1 1 0 0 0 1.414 1.414zM21 10V4h-2v6zm-1-7h-6v2h6zm-.707.293l-5 5l1.414 1.414l5-5zM4 4V3H3v1zm4.293 5.707a1 1 0 0 0 1.414-1.414zM5 10V4H3v6zM4 5h6V3H4zm-.707-.293l5 5l1.414-1.414l-5-5z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" style="margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M17.65 6.35a7.95 7.95 0 0 0-6.48-2.31c-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20a7.98 7.98 0 0 0 7.21-4.56c.32-.67-.16-1.44-.9-1.44c-.37 0-.72.2-.88.53a5.994 5.994 0 0 1-6.8 3.31c-2.22-.49-4.01-2.3-4.48-4.52A6.002 6.002 0 0 1 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"></path></svg></summary><div data-v-ee1a9bd0="" class="resizable" style="width: 780px; max-width: 100%; height: 70vh; min-height: 500px; overflow: hidden; resize: both;"><iframe data-v-ee1a9bd0="" title="algo-visualize panel" allow="clipboard-write; fullscreen;" id="iframe_number-of-visible-people-in-a-queue" src="https://labuladong.online/algo-visualize/leetcode/number-of-visible-people-in-a-queue/" width="100%" height="100%" loading="lazy" scrolling="auto" frameborder="0" style="overflow: auto;"></iframe></div></details>

## [1475. å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼](https://labuladong.online/algo/problem-set/monotonic-stack/#slug_final-prices-with-a-special-discount-in-a-shop)

<details class="hint-container details" open="" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1.25rem 1rem; border-radius: 0.5rem; color: rgb(60, 60, 67); font-family: Inter, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="position: relative; margin: -1rem -1rem 0.5em; padding-block: 1em; padding-inline: 3em 1.5em; list-style: none; font-size: 16px; cursor: pointer;"><strong style="font-weight: 600;">1475. å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼</strong>&nbsp;|<span>&nbsp;</span><span><a href="https://leetcode.cn/problems/final-prices-with-a-special-discount-in-a-shop/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£</a><span>&nbsp;</span>|<span>&nbsp;</span></span><span><a href="https://leetcode.com/problems/final-prices-with-a-special-discount-in-a-shop/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">LeetCode</a><span>&nbsp;</span>|</span><span>&nbsp;</span>&nbsp;ğŸŸ¢</summary><div><p style="line-height: 1.6; overflow-wrap: break-word;">ç»™ä½ ä¸€ä¸ªæ•°ç»„&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">prices</code>&nbsp;ï¼Œå…¶ä¸­&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">prices[i]</code>&nbsp;æ˜¯å•†åº—é‡Œç¬¬&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code>&nbsp;ä»¶å•†å“çš„ä»·æ ¼ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">å•†åº—é‡Œæ­£åœ¨è¿›è¡Œä¿ƒé”€æ´»åŠ¨ï¼Œå¦‚æœä½ è¦ä¹°ç¬¬&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code>&nbsp;ä»¶å•†å“ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¾—åˆ°ä¸<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">prices[j]</code><span>&nbsp;</span>ç›¸ç­‰çš„æŠ˜æ‰£ï¼Œå…¶ä¸­&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">j</code>&nbsp;æ˜¯æ»¡è¶³&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">j &gt; i</code>&nbsp;ä¸”&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">prices[j] &lt;= prices[i]</code>&nbsp;çš„&nbsp;<strong style="font-weight: 600;">æœ€å°ä¸‹æ ‡</strong>&nbsp;ï¼Œå¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">j</code>&nbsp;ï¼Œä½ å°†æ²¡æœ‰ä»»ä½•æŠ˜æ‰£ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">è¯·ä½ è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­ç¬¬&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code>&nbsp;ä¸ªå…ƒç´ æ˜¯æŠ˜æ‰£åä½ è´­ä¹°å•†å“<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code>&nbsp;æœ€ç»ˆéœ€è¦æ”¯ä»˜çš„ä»·æ ¼ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 1ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>prices = [8,4,6,2,3]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>[4,2,4,2,3]
<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>
å•†å“ 0 çš„ä»·æ ¼ä¸º price[0]=8 ï¼Œä½ å°†å¾—åˆ° prices[1]=4 çš„æŠ˜æ‰£ï¼Œæ‰€ä»¥æœ€ç»ˆä»·æ ¼ä¸º 8 - 4 = 4 ã€‚
å•†å“ 1 çš„ä»·æ ¼ä¸º price[1]=4 ï¼Œä½ å°†å¾—åˆ° prices[3]=2 çš„æŠ˜æ‰£ï¼Œæ‰€ä»¥æœ€ç»ˆä»·æ ¼ä¸º 4 - 2 = 2 ã€‚
å•†å“ 2 çš„ä»·æ ¼ä¸º price[2]=6 ï¼Œä½ å°†å¾—åˆ° prices[3]=2 çš„æŠ˜æ‰£ï¼Œæ‰€ä»¥æœ€ç»ˆä»·æ ¼ä¸º 6 - 2 = 4 ã€‚
å•†å“ 3 å’Œ 4 éƒ½æ²¡æœ‰æŠ˜æ‰£ã€‚
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 2ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>prices = [1,2,3,4,5]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>[1,2,3,4,5]
<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ‰€æœ‰å•†å“éƒ½æ²¡æœ‰æŠ˜æ‰£ã€‚
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 3ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>prices = [10,1,1,6]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>[9,0,1,6]
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">æç¤ºï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= prices.length &lt;= 500</code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= prices[i] &lt;= 10^3</code></li></ul></div><strong style="font-weight: 600; font-size: small;">é¢˜ç›®æ¥æºï¼š<a href="https://leetcode.cn/problems/final-prices-with-a-special-discount-in-a-shop/" class="" target="_blank" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£ 1475. å•†å“æŠ˜æ‰£åçš„æœ€ç»ˆä»·æ ¼</a>ã€‚</strong></details>

### [åŸºæœ¬æ€è·¯](https://labuladong.online/algo/problem-set/monotonic-stack/#åŸºæœ¬æ€è·¯-2)

è¿™é“é¢˜å°±ç”¨åˆ°äº† [å•è°ƒæ ˆçš„å‡ ç§æ¨¡æ¿å®ç°](https://labuladong.online/algo/problem-set/monotonic-stack/) ä¸­è®²åˆ°çš„ä¸€ä¸ªå•è°ƒæ ˆæ¨¡æ¿ï¼šè®¡ç®—ä¸‹ä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ ã€‚æˆ‘æ˜¯ä¸ºäº†è¿ç”¨æ¨¡æ¿ï¼Œæ‰€ä»¥æŠŠè§£æ³•åˆ†æˆäº†ä¸¤ä¸ªå‡½æ•°ï¼Œæ•ˆç‡å¯èƒ½ä¼šé™ä½ä¸€äº›ï¼Œä½ å®Œå…¨å¯ä»¥ä¼˜åŒ–è¿™ä¸ªè§£æ³•çš„å½¢å¼ï¼Œä½¿ä¹‹æ›´é«˜æ•ˆã€‚

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/)

### [è§£æ³•ä»£ç ](https://labuladong.online/algo/problem-set/monotonic-stack/#è§£æ³•ä»£ç -2)


``` PYTHON
class Solution:
    def finalPrices(self, prices: List[int]) -> List[int]:
        n = len(prices)
        res = [0] * n
        # ä¸‹ä¸€ä¸ªå°äºç­‰äº price[i] çš„ä»·æ ¼å°±æ˜¯ä¼˜æƒ åˆ¸æŠ˜æ‰£
        next_element = self.nextLessOrEqualElement(prices)
        for i in range(len(prices)):
            # å¦‚æœå­˜åœ¨ä¼˜æƒ åˆ¸ï¼Œåˆ™å‡å°‘ç›¸åº”çš„ä»·æ ¼
            if next_element[i] != -1:
                res[i] = prices[i] - next_element[i]
            else:
                res[i] = prices[i]
        return res

    # å•è°ƒæ ˆæ¨¡æ¿ï¼šè®¡ç®— nums ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªæ›´å°æˆ–ç›¸ç­‰çš„å…ƒç´ 
    def nextLessOrEqualElement(self, nums: List[int]) -> List[int]:
        n = len(nums)
        # å­˜æ”¾ç­”æ¡ˆçš„æ•°ç»„
        res = [-1] * n
        s = []
        # å€’ç€å¾€æ ˆé‡Œæ”¾
        for i in range(n - 1, -1, -1):
            # åˆ æ‰ nums[i] åé¢è¾ƒå¤§çš„å…ƒç´ 
            while s and s[-1] > nums[i]:
                s.pop()
            # ç°åœ¨æ ˆé¡¶å°±æ˜¯ nums[i] èº«åçš„æ›´å°æˆ–ç›¸ç­‰å…ƒç´ 
            res[i] = s[-1] if s else -1
            s.append(nums[i])
        return res
```

### [å¯è§†åŒ–](https://labuladong.online/algo/problem-set/monotonic-stack/#å¯è§†åŒ–-2)

<details data-v-ee1a9bd0="" id="div_final-prices-with-a-special-discount-in-a-shop" class="hint-container details" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1rem 0px 0px; border-radius: 0.5rem; margin: 1.3em 0px;"><summary data-v-ee1a9bd0="" style="position: relative; margin: -1rem 0px 0px; padding-block: 1em; padding-inline: 2.3em 1.5em; list-style: none; font-size: large; cursor: pointer; display: flex; align-items: center;"><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="m4.415 18.167l7.17-7.17l1.414 1.414l-7.17 7.17z" opacity="0.3"></path><path data-v-ee1a9bd0="" fill="currentColor" d="m20 7l.94-2.06L23 4l-2.06-.94L20 1l-.94 2.06L17 4l2.06.94zM8.5 7l.94-2.06L11.5 4l-2.06-.94L8.5 1l-.94 2.06L5.5 4l2.06.94zM20 12.5l-.94 2.06l-2.06.94l2.06.94l.94 2.06l.94-2.06L23 15.5l-2.06-.94zm-2.29-3.38l-2.83-2.83c-.2-.19-.45-.29-.71-.29s-.51.1-.71.29L2.29 17.46a.996.996 0 0 0 0 1.41l2.83 2.83c.2.2.45.3.71.3s.51-.1.71-.29l11.17-11.17c.39-.39.39-1.03 0-1.42M5.83 19.59l-1.41-1.41L11.59 11L13 12.41zM14.41 11L13 9.59l1.17-1.17l1.41 1.41z"></path></svg>&nbsp;<strong data-v-ee1a9bd0="" style="font-weight: 600;">ç®—æ³•å¯è§†åŒ–é¢æ¿</strong><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" style="margin-left: auto; margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M20 20v1h1v-1zm-4.293-5.707a1 1 0 0 0-1.414 1.414zM19 14v6h2v-6zm1 5h-6v2h6zm.707.293l-5-5l-1.414 1.414l5 5zM4 20H3v1h1zm5.707-4.293a1 1 0 0 0-1.414-1.414zM3 14v6h2v-6zm1 7h6v-2H4zm.707-.293l5-5l-1.414-1.414l-5 5zM20 4h1V3h-1zm-5.707 4.293a1 1 0 0 0 1.414 1.414zM21 10V4h-2v6zm-1-7h-6v2h6zm-.707.293l-5 5l1.414 1.414l5-5zM4 4V3H3v1zm4.293 5.707a1 1 0 0 0 1.414-1.414zM5 10V4H3v6zM4 5h6V3H4zm-.707-.293l5 5l1.414-1.414l-5-5z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" style="margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M17.65 6.35a7.95 7.95 0 0 0-6.48-2.31c-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20a7.98 7.98 0 0 0 7.21-4.56c.32-.67-.16-1.44-.9-1.44c-.37 0-.72.2-.88.53a5.994 5.994 0 0 1-6.8 3.31c-2.22-.49-4.01-2.3-4.48-4.52A6.002 6.002 0 0 1 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"></path></svg></summary><div data-v-ee1a9bd0="" class="resizable" style="width: 780px; max-width: 100%; height: 70vh; min-height: 500px; overflow: hidden; resize: both;"><iframe data-v-ee1a9bd0="" title="algo-visualize panel" allow="clipboard-write; fullscreen;" id="iframe_final-prices-with-a-special-discount-in-a-shop" src="https://labuladong.online/algo-visualize/leetcode/final-prices-with-a-special-discount-in-a-shop/" width="100%" height="100%" loading="lazy" scrolling="auto" frameborder="0" style="overflow: auto;"></iframe></div></details>

## [901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦](https://labuladong.online/algo/problem-set/monotonic-stack/#slug_online-stock-span)

<details class="hint-container details" open="" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1.25rem 1rem; border-radius: 0.5rem; color: rgb(60, 60, 67); font-family: Inter, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="position: relative; margin: -1rem -1rem 0.5em; padding-block: 1em; padding-inline: 3em 1.5em; list-style: none; font-size: 16px; cursor: pointer;"><strong style="font-weight: 600;">901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦</strong>&nbsp;|<span>&nbsp;</span><span><a href="https://leetcode.cn/problems/online-stock-span/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£</a><span>&nbsp;</span>|<span>&nbsp;</span></span><span><a href="https://leetcode.com/problems/online-stock-span/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">LeetCode</a><span>&nbsp;</span>|</span><span>&nbsp;</span>&nbsp;ğŸŸ </summary><div><p style="line-height: 1.6; overflow-wrap: break-word;">è®¾è®¡ä¸€ä¸ªç®—æ³•æ”¶é›†æŸäº›è‚¡ç¥¨çš„æ¯æ—¥æŠ¥ä»·ï¼Œå¹¶è¿”å›è¯¥è‚¡ç¥¨å½“æ—¥ä»·æ ¼çš„<span>&nbsp;</span><strong style="font-weight: 600;">è·¨åº¦</strong><span>&nbsp;</span>ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">å½“æ—¥è‚¡ç¥¨ä»·æ ¼çš„<span>&nbsp;</span><strong style="font-weight: 600;">è·¨åº¦</strong><span>&nbsp;</span>è¢«å®šä¹‰ä¸ºè‚¡ç¥¨ä»·æ ¼å°äºæˆ–ç­‰äºä»Šå¤©ä»·æ ¼çš„æœ€å¤§è¿ç»­æ—¥æ•°ï¼ˆä»ä»Šå¤©å¼€å§‹å¾€å›æ•°ï¼ŒåŒ…æ‹¬ä»Šå¤©ï¼‰ã€‚</p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><p style="line-height: 1.6; overflow-wrap: break-word; margin-bottom: 0px; padding-bottom: 0px;">ä¾‹å¦‚ï¼Œå¦‚æœæœªæ¥ 7 å¤©è‚¡ç¥¨çš„ä»·æ ¼æ˜¯<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">[100,80,60,70,60,75,85]</code>ï¼Œé‚£ä¹ˆè‚¡ç¥¨è·¨åº¦å°†æ˜¯<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">[1,1,1,2,1,4,6]</code><span>&nbsp;</span>ã€‚</p></li></ul><p style="line-height: 1.6; overflow-wrap: break-word;">å®ç°<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">StockSpanner</code><span>&nbsp;</span>ç±»ï¼š</p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">StockSpanner()</code><span>&nbsp;</span>åˆå§‹åŒ–ç±»å¯¹è±¡ã€‚</li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">int next(int price)</code><span>&nbsp;</span>ç»™å‡ºä»Šå¤©çš„è‚¡ä»·<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">price</code><span>&nbsp;</span>ï¼Œè¿”å›è¯¥è‚¡ç¥¨å½“æ—¥ä»·æ ¼çš„<span>&nbsp;</span><strong style="font-weight: 600;">è·¨åº¦</strong><span>&nbsp;</span>ã€‚</li></ul><p style="line-height: 1.6; overflow-wrap: break-word;"><strong class="example" style="font-weight: 600;">ç¤ºä¾‹ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥</strong>ï¼š
["StockSpanner", "next", "next", "next", "next", "next", "next", "next"]
[[], [100], [80], [60], [70], [60], [75], [85]]
<strong style="font-weight: 600;">è¾“å‡º</strong>ï¼š
[null, 1, 1, 1, 2, 1, 4, 6]

<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>
StockSpanner stockSpanner = new StockSpanner();
stockSpanner.next(100); // è¿”å› 1
stockSpanner.next(80);  // è¿”å› 1
stockSpanner.next(60);  // è¿”å› 1
stockSpanner.next(70);  // è¿”å› 2
stockSpanner.next(60);  // è¿”å› 1
stockSpanner.next(75);  // è¿”å› 4 ï¼Œå› ä¸ºæˆªè‡³ä»Šå¤©çš„æœ€å 4 ä¸ªè‚¡ä»· (åŒ…æ‹¬ä»Šå¤©çš„è‚¡ä»· 75) éƒ½å°äºæˆ–ç­‰äºä»Šå¤©çš„è‚¡ä»·ã€‚
stockSpanner.next(85);  // è¿”å› 6
</pre>&nbsp;<p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">æç¤ºï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= price &lt;= 10<sup>5</sup></code></li><li>æœ€å¤šè°ƒç”¨<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">next</code><span>&nbsp;</span>æ–¹æ³•<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">10<sup>4</sup></code><span>&nbsp;</span>æ¬¡</li></ul></div><strong style="font-weight: 600; font-size: small;">é¢˜ç›®æ¥æºï¼š<a href="https://leetcode.cn/problems/online-stock-span/" class="" target="_blank" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£ 901. è‚¡ç¥¨ä»·æ ¼è·¨åº¦</a>ã€‚</strong></details>

### [åŸºæœ¬æ€è·¯](https://labuladong.online/algo/problem-set/monotonic-stack/#åŸºæœ¬æ€è·¯-3)

è¿™é“é¢˜æ˜¾ç„¶è¦ç”¨åˆ° [å•è°ƒæ ˆæŠ€å·§](https://labuladong.online/algo/data-structure/monotonic-stack/)ï¼šå½“åŠ å…¥ `price` æ—¶ï¼ŒæŠŠæ‰€æœ‰å°äºç­‰äº `price` çš„ä»·æ ¼éƒ½ã€ŒæŒ¤æ‰ã€ï¼Œç›¸å½“äºè®¡ç®—å‰ä¸€ä¸ªæ›´å¤§å…ƒç´ ï¼Œå³ [å•è°ƒæ ˆçš„å‡ ç§æ¨¡æ¿å®ç°](https://labuladong.online/algo/problem-set/monotonic-stack/) ä¸­çš„ `prevGreaterElement` å‡½æ•°ã€‚

æ¯”å¦‚å·²ç»å…¥æ ˆçš„ä»·æ ¼åºåˆ—æ˜¯ `[40, 30, 20, 10]`ï¼Œé‚£ä¹ˆå¦‚æœæ‰§è¡Œ `next(25)`ï¼Œä»·æ ¼åºåˆ—å˜æˆ `[40, 30, 25]`ï¼Œ20 å’Œ 10 éƒ½ä¼šè¢«ã€ŒæŒ¤æ‰ã€ï¼Œç®—ä¸Š 25 æœ¬èº«ï¼Œå‡½æ•°è¿”å› 2 + 1 = 3ã€‚

**ä½†è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œè¿™ä¸ª 3 åº”è¯¥ä½œä¸ºã€Œæƒé‡ã€å’Œ 25 ä¸€åŒå­˜å‚¨åœ¨æ ˆä¸­**ã€‚å› ä¸ºä¹‹å 25 è¿˜å¯èƒ½è¢«æŒ¤æ‰ï¼Œæ¯”å¦‚è¯´æ‰§è¡Œ `next(26)`ï¼Œä»·æ ¼åºåˆ—å°±å˜æˆäº† `[40, 30, 26]`ï¼Œä½†è¿™ç§æƒ…å†µä¸‹ä¹‹å‰çš„ 20 å’Œ 10 æ˜¾ç„¶ä¹Ÿåº”è¯¥è¢«æŒ¤æ‰ï¼Œå‡½æ•°åº”è¯¥è¿”å› 3 + 1 = 4ã€‚å…·ä½“è§£æ³•çœ‹ä»£ç å§ã€‚

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/)

### [è§£æ³•ä»£ç ](https://labuladong.online/algo/problem-set/monotonic-stack/#è§£æ³•ä»£ç -3)


``` PYTHON
class StockSpanner:
    # int[] è®°å½• {ä»·æ ¼ï¼Œå°äºç­‰äºè¯¥ä»·æ ¼çš„å¤©æ•°} äºŒå…ƒç»„
    def __init__(self):
        self.stk = []

    def next(self, price: int) -> int:
        # ç®—ä¸Šå½“å¤©
        count = 1
        # å•è°ƒæ ˆæ¨¡æ¿
        while self.stk and price >= self.stk[-1][0]:
            # æŒ¤æ‰ä»·æ ¼ä½äº price çš„è®°å½•
            prev = self.stk.pop()
            # è®¡ç®—å°äºç­‰äº price çš„å¤©æ•°
            count += prev[1]
        self.stk.append([price, count])

        return count
```

## [402. ç§»æ‰ K ä½æ•°å­—](https://labuladong.online/algo/problem-set/monotonic-stack/#slug_remove-k-digits)

<details class="hint-container details" open="" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1.25rem 1rem; border-radius: 0.5rem; color: rgb(60, 60, 67); font-family: Inter, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="position: relative; margin: -1rem -1rem 0.5em; padding-block: 1em; padding-inline: 3em 1.5em; list-style: none; font-size: 16px; cursor: pointer;"><strong style="font-weight: 600;">402. ç§»æ‰ K ä½æ•°å­—</strong>&nbsp;|<span>&nbsp;</span><span><a href="https://leetcode.cn/problems/remove-k-digits/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£</a><span>&nbsp;</span>|<span>&nbsp;</span></span><span><a href="https://leetcode.com/problems/remove-k-digits/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">LeetCode</a><span>&nbsp;</span>|</span><span>&nbsp;</span>&nbsp;ğŸŸ </summary><div><p style="line-height: 1.6; overflow-wrap: break-word;">ç»™ä½ ä¸€ä¸ªä»¥å­—ç¬¦ä¸²è¡¨ç¤ºçš„éè´Ÿæ•´æ•°<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">num</code><span>&nbsp;</span>å’Œä¸€ä¸ªæ•´æ•°<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">k</code><span>&nbsp;</span>ï¼Œç§»é™¤è¿™ä¸ªæ•°ä¸­çš„<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">k</code><em><span>&nbsp;</span></em>ä½æ•°å­—ï¼Œä½¿å¾—å‰©ä¸‹çš„æ•°å­—æœ€å°ã€‚è¯·ä½ ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›è¿™ä¸ªæœ€å°çš„æ•°å­—ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 1 ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>num = "1432219", k = 3
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>"1219"
<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>ç§»é™¤æ‰ä¸‰ä¸ªæ•°å­— 4, 3, å’Œ 2 å½¢æˆä¸€ä¸ªæ–°çš„æœ€å°çš„æ•°å­— 1219 ã€‚
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 2 ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>num = "10200", k = 1
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>"200"
<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>ç§»æ‰é¦–ä½çš„ 1 å‰©ä¸‹çš„æ•°å­—ä¸º 200. æ³¨æ„è¾“å‡ºä¸èƒ½æœ‰ä»»ä½•å‰å¯¼é›¶ã€‚
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 3 ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>num = "10", k = 2
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>"0"
<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>ä»åŸæ•°å­—ç§»é™¤æ‰€æœ‰çš„æ•°å­—ï¼Œå‰©ä½™ä¸ºç©ºå°±æ˜¯ 0 ã€‚
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">æç¤ºï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= k &lt;= num.length &lt;= 10<sup>5</sup></code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">num</code><span>&nbsp;</span>ä»…ç”±è‹¥å¹²ä½æ•°å­—ï¼ˆ0 - 9ï¼‰ç»„æˆ</li><li>é™¤äº†<span>&nbsp;</span><strong style="font-weight: 600;">0</strong><span>&nbsp;</span>æœ¬èº«ä¹‹å¤–ï¼Œ<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">num</code><span>&nbsp;</span>ä¸å«ä»»ä½•å‰å¯¼é›¶</li></ul></div><strong style="font-weight: 600; font-size: small;">é¢˜ç›®æ¥æºï¼š<a href="https://leetcode.cn/problems/remove-k-digits/" class="" target="_blank" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£ 402. ç§»æ‰ K ä½æ•°å­—</a>ã€‚</strong></details>

### [åŸºæœ¬æ€è·¯](https://labuladong.online/algo/problem-set/monotonic-stack/#åŸºæœ¬æ€è·¯-4)

å¦‚æœæƒ³è®©ç»“æœå°½å¯èƒ½å°ï¼Œé‚£ä¹ˆæ¸…é™¤æ•°å­—åˆ†ä¸¤æ­¥ï¼š

1ã€å…ˆåˆ é™¤ `num` ä¸­çš„è‹¥å¹²æ•°å­—ï¼Œä½¿å¾— `num` ä»å·¦åˆ°å³æ¯ä¸€ä½éƒ½å•è°ƒé€’å¢ã€‚æ¯”å¦‚ `14329` è½¬åŒ–æˆ `129`ï¼Œè¿™éœ€è¦ä½¿ç”¨åˆ° [å•è°ƒæ ˆæŠ€å·§](https://labuladong.online/algo/data-structure/monotonic-stack/)ã€‚

2ã€`num` ä¸­çš„æ¯ä¸€ä½å˜æˆå•è°ƒé€’å¢çš„ä¹‹åï¼Œå¦‚æœ `k` è¿˜å¤§äº 0ï¼ˆè¿˜å¯ä»¥ç»§ç»­åˆ é™¤ï¼‰çš„è¯ï¼Œåˆ™åˆ é™¤å°¾éƒ¨çš„æ•°å­—ï¼Œæ¯”å¦‚ `129` åˆ é™¤æˆ `12`ã€‚

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/)

### [è§£æ³•ä»£ç ](https://labuladong.online/algo/problem-set/monotonic-stack/#è§£æ³•ä»£ç -4)


``` PYTHON
class Solution:
    def removeKdigits(self, num: str, k: int) -> str:
        stk = []
        for c in num:
            # å•è°ƒæ ˆä»£ç æ¨¡æ¿
            while stk and k > 0 and c < stk[-1]:
                stk.pop()
                k -= 1
            # é˜²æ­¢ 0 ä½œä¸ºæ•°å­—çš„å¼€å¤´
            if not stk and c == '0':
                continue
            stk.append(c)

        # æ­¤æ—¶æ ˆä¸­å…ƒç´ å•è°ƒé€’å¢ï¼Œè‹¥ k è¿˜æ²¡ç”¨å®Œçš„è¯åˆ æ‰æ ˆé¡¶å…ƒç´ 
        final_stack = stk[:-k] if k else stk

        # å°†æ ˆä¸­å­—ç¬¦è½¬åŒ–æˆå­—ç¬¦ä¸²
        # å‡ºæ ˆé¡ºåºå’Œå­—ç¬¦ä¸²é¡ºåºæ˜¯åçš„
        result = ''.join(final_stack).lstrip('0')

        # è‹¥æœ€åæ²¡å‰©ä¸‹æ•°å­—ï¼Œå°±æ˜¯ 0
        return result if result else '0'
```

### [å¯è§†åŒ–](https://labuladong.online/algo/problem-set/monotonic-stack/#å¯è§†åŒ–-3)

<details data-v-ee1a9bd0="" id="div_remove-k-digits" class="hint-container details" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1rem 0px 0px; border-radius: 0.5rem; margin: 1.3em 0px;"><summary data-v-ee1a9bd0="" style="position: relative; margin: -1rem 0px 0px; padding-block: 1em; padding-inline: 2.3em 1.5em; list-style: none; font-size: large; cursor: pointer; display: flex; align-items: center;"><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="m4.415 18.167l7.17-7.17l1.414 1.414l-7.17 7.17z" opacity="0.3"></path><path data-v-ee1a9bd0="" fill="currentColor" d="m20 7l.94-2.06L23 4l-2.06-.94L20 1l-.94 2.06L17 4l2.06.94zM8.5 7l.94-2.06L11.5 4l-2.06-.94L8.5 1l-.94 2.06L5.5 4l2.06.94zM20 12.5l-.94 2.06l-2.06.94l2.06.94l.94 2.06l.94-2.06L23 15.5l-2.06-.94zm-2.29-3.38l-2.83-2.83c-.2-.19-.45-.29-.71-.29s-.51.1-.71.29L2.29 17.46a.996.996 0 0 0 0 1.41l2.83 2.83c.2.2.45.3.71.3s.51-.1.71-.29l11.17-11.17c.39-.39.39-1.03 0-1.42M5.83 19.59l-1.41-1.41L11.59 11L13 12.41zM14.41 11L13 9.59l1.17-1.17l1.41 1.41z"></path></svg>&nbsp;<strong data-v-ee1a9bd0="" style="font-weight: 600;">ç®—æ³•å¯è§†åŒ–é¢æ¿</strong><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" style="margin-left: auto; margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M20 20v1h1v-1zm-4.293-5.707a1 1 0 0 0-1.414 1.414zM19 14v6h2v-6zm1 5h-6v2h6zm.707.293l-5-5l-1.414 1.414l5 5zM4 20H3v1h1zm5.707-4.293a1 1 0 0 0-1.414-1.414zM3 14v6h2v-6zm1 7h6v-2H4zm.707-.293l5-5l-1.414-1.414l-5 5zM20 4h1V3h-1zm-5.707 4.293a1 1 0 0 0 1.414 1.414zM21 10V4h-2v6zm-1-7h-6v2h6zm-.707.293l-5 5l1.414 1.414l5-5zM4 4V3H3v1zm4.293 5.707a1 1 0 0 0 1.414-1.414zM5 10V4H3v6zM4 5h6V3H4zm-.707-.293l5 5l1.414-1.414l-5-5z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" style="margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M17.65 6.35a7.95 7.95 0 0 0-6.48-2.31c-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20a7.98 7.98 0 0 0 7.21-4.56c.32-.67-.16-1.44-.9-1.44c-.37 0-.72.2-.88.53a5.994 5.994 0 0 1-6.8 3.31c-2.22-.49-4.01-2.3-4.48-4.52A6.002 6.002 0 0 1 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"></path></svg></summary><div data-v-ee1a9bd0="" class="resizable" style="width: 780px; max-width: 100%; height: 70vh; min-height: 500px; overflow: hidden; resize: both;"><iframe data-v-ee1a9bd0="" title="algo-visualize panel" allow="clipboard-write; fullscreen;" id="iframe_remove-k-digits" src="https://labuladong.online/algo-visualize/leetcode/remove-k-digits/" width="100%" height="100%" loading="lazy" scrolling="auto" frameborder="0" style="overflow: auto;"></iframe></div></details>

## [853. è½¦é˜Ÿ](https://labuladong.online/algo/problem-set/monotonic-stack/#slug_car-fleet)

<details class="hint-container details" open="" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1.25rem 1rem; border-radius: 0.5rem; color: rgb(60, 60, 67); font-family: Inter, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="position: relative; margin: -1rem -1rem 0.5em; padding-block: 1em; padding-inline: 3em 1.5em; list-style: none; font-size: 16px; cursor: pointer;"><strong style="font-weight: 600;">853. è½¦é˜Ÿ</strong>&nbsp;|<span>&nbsp;</span><span><a href="https://leetcode.cn/problems/car-fleet/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£</a><span>&nbsp;</span>|<span>&nbsp;</span></span><span><a href="https://leetcode.com/problems/car-fleet/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">LeetCode</a><span>&nbsp;</span>|</span><span>&nbsp;</span>&nbsp;ğŸŸ </summary><div><p style="line-height: 1.6; overflow-wrap: break-word;">åœ¨ä¸€æ¡å•è¡Œé“ä¸Šï¼Œæœ‰<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n</code><span>&nbsp;</span>è¾†è½¦å¼€å¾€åŒä¸€ç›®çš„åœ°ã€‚ç›®çš„åœ°æ˜¯å‡ è‹±é‡Œä»¥å¤–çš„&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">target</code>&nbsp;ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">ç»™å®šä¸¤ä¸ªæ•´æ•°æ•°ç»„&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">position</code>&nbsp;å’Œ&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">speed</code>&nbsp;ï¼Œé•¿åº¦éƒ½æ˜¯<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n</code><span>&nbsp;</span>ï¼Œå…¶ä¸­&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">position[i]</code>&nbsp;æ˜¯ç¬¬<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code><span>&nbsp;</span>è¾†è½¦çš„ä½ç½®ï¼Œ&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">speed[i]</code>&nbsp;æ˜¯ç¬¬<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">i</code><span>&nbsp;</span>è¾†è½¦çš„é€Ÿåº¦(å•ä½æ˜¯è‹±é‡Œ/å°æ—¶)ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">ä¸€è¾†è½¦æ°¸è¿œä¸ä¼šè¶…è¿‡å‰é¢çš„å¦ä¸€è¾†è½¦ï¼Œä½†å®ƒå¯ä»¥è¿½ä¸Šå»ï¼Œå¹¶ä»¥è¾ƒæ…¢è½¦çš„é€Ÿåº¦åœ¨å¦ä¸€è¾†è½¦æ—è¾¹è¡Œé©¶ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">è½¦é˜Ÿ<span>&nbsp;</span></strong>æ˜¯æŒ‡å¹¶æ’è¡Œé©¶çš„ä¸€è¾†æˆ–å‡ è¾†æ±½è½¦ã€‚è½¦é˜Ÿçš„é€Ÿåº¦æ˜¯è½¦é˜Ÿä¸­<span>&nbsp;</span><strong style="font-weight: 600;">æœ€æ…¢</strong><span>&nbsp;</span>çš„è½¦çš„é€Ÿåº¦ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">å³ä¾¿ä¸€è¾†è½¦åœ¨&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">target</code><span>&nbsp;</span>æ‰èµ¶ä¸Šäº†ä¸€ä¸ªè½¦é˜Ÿï¼Œå®ƒä»¬ä»ç„¶ä¼šè¢«è§†ä½œæ˜¯åŒä¸€ä¸ªè½¦é˜Ÿã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">è¿”å›åˆ°è¾¾ç›®çš„åœ°çš„è½¦é˜Ÿæ•°é‡ ã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong class="example" style="font-weight: 600;">ç¤ºä¾‹ 1ï¼š</strong></p><div class="example-block"><p style="line-height: 1.6; overflow-wrap: break-word;"><span class="example-io"><b>è¾“å…¥ï¼š</b>target = 12, position = [10,8,0,5,3], speed = [2,4,1,1,3]</span></p><p style="line-height: 1.6; overflow-wrap: break-word;"><span class="example-io"><b>è¾“å‡ºï¼š</b>3</span></p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">è§£é‡Šï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li>ä» 10ï¼ˆé€Ÿåº¦ä¸º 2ï¼‰å’Œ 8ï¼ˆé€Ÿåº¦ä¸º 4ï¼‰å¼€å§‹çš„è½¦ä¼šç»„æˆä¸€ä¸ªè½¦é˜Ÿï¼Œå®ƒä»¬åœ¨ 12 ç›¸é‡ã€‚è½¦é˜Ÿåœ¨&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">target</code>&nbsp;å½¢æˆã€‚</li><li>ä» 0ï¼ˆé€Ÿåº¦ä¸º 1ï¼‰å¼€å§‹çš„è½¦ä¸ä¼šè¿½ä¸Šå…¶å®ƒä»»ä½•è½¦ï¼Œæ‰€ä»¥å®ƒè‡ªå·±æ˜¯ä¸€ä¸ªè½¦é˜Ÿã€‚</li><li>ä» 5ï¼ˆé€Ÿåº¦ä¸º 1ï¼‰ å’Œ 3ï¼ˆé€Ÿåº¦ä¸º 3ï¼‰å¼€å§‹çš„è½¦ç»„æˆä¸€ä¸ªè½¦é˜Ÿï¼Œåœ¨ 6 ç›¸é‡ã€‚è½¦é˜Ÿä»¥é€Ÿåº¦ 1 ç§»åŠ¨ç›´åˆ°å®ƒåˆ°è¾¾&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">target</code>ã€‚</li></ul></div><p style="line-height: 1.6; overflow-wrap: break-word;"><strong class="example" style="font-weight: 600;">ç¤ºä¾‹ 2ï¼š</strong></p><div class="example-block"><p style="line-height: 1.6; overflow-wrap: break-word;"><span class="example-io"><b>è¾“å…¥ï¼š</b></span><span class="example-io">target = 10, position = [3], speed = [3]</span></p><p style="line-height: 1.6; overflow-wrap: break-word;"><span class="example-io"><b>è¾“å‡ºï¼š</b></span><span class="example-io">1</span></p><p style="line-height: 1.6; overflow-wrap: break-word; margin-bottom: 0px; padding-bottom: 0px;"><strong style="font-weight: 600;">è§£é‡Šï¼š</strong></p>åªæœ‰ä¸€è¾†è½¦ï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªè½¦é˜Ÿã€‚</div><p style="line-height: 1.6; overflow-wrap: break-word;"><strong class="example" style="font-weight: 600;">ç¤ºä¾‹ 3ï¼š</strong></p><div class="example-block"><p style="line-height: 1.6; overflow-wrap: break-word;"><span class="example-io"><b>è¾“å…¥ï¼š</b></span><span class="example-io">target = 100, position = [0,2,4], speed = [4,2,1]</span></p><p style="line-height: 1.6; overflow-wrap: break-word;"><span class="example-io"><b>è¾“å‡ºï¼š</b></span><span class="example-io">1</span></p><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">è§£é‡Šï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li>ä» 0ï¼ˆé€Ÿåº¦ä¸º 4ï¼‰ å’Œ 2ï¼ˆé€Ÿåº¦ä¸º 2ï¼‰å¼€å§‹çš„è½¦ç»„æˆä¸€ä¸ªè½¦é˜Ÿï¼Œåœ¨ 4&nbsp;ç›¸é‡ã€‚ä» 4 å¼€å§‹çš„è½¦ï¼ˆé€Ÿåº¦ä¸º 1ï¼‰ç§»åŠ¨åˆ°äº† 5ã€‚</li><li>ç„¶åï¼Œåœ¨ 4ï¼ˆé€Ÿåº¦ä¸º 2ï¼‰çš„è½¦é˜Ÿå’Œåœ¨ 5ï¼ˆé€Ÿåº¦ä¸º 1ï¼‰çš„è½¦æˆä¸ºä¸€ä¸ªè½¦é˜Ÿï¼Œåœ¨ 6 ç›¸é‡ã€‚è½¦é˜Ÿä»¥é€Ÿåº¦ 1 ç§»åŠ¨ç›´åˆ°å®ƒåˆ°è¾¾&nbsp;<code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">target</code>ã€‚</li></ul></div><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">æç¤ºï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">n == position.length == speed.length</code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= n &lt;= 10<sup>5</sup></code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">0 &lt; target &lt;= 10<sup>6</sup></code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">0 &lt;= position[i] &lt; target</code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">position</code>&nbsp;ä¸­æ¯ä¸ªå€¼éƒ½<span>&nbsp;</span><strong style="font-weight: 600;">ä¸åŒ</strong></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">0 &lt; speed[i] &lt;= 10<sup>6</sup></code></li></ul></div><strong style="font-weight: 600; font-size: small;">é¢˜ç›®æ¥æºï¼š<a href="https://leetcode.cn/problems/car-fleet/" class="" target="_blank" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£ 853. è½¦é˜Ÿ</a>ã€‚</strong></details>

### [åŸºæœ¬æ€è·¯](https://labuladong.online/algo/problem-set/monotonic-stack/#åŸºæœ¬æ€è·¯-5)

è¿™é¢˜è€ƒå¯Ÿã€Œå•è°ƒæ ˆã€ç»“æ„çš„ä½¿ç”¨ã€‚æ˜¯å¦èƒ½å¤Ÿå½¢æˆè½¦é˜Ÿï¼Œå–å†³äºä¸‹è¿°è§„å¾‹ï¼š

**å¦‚æœè½¦ `x` æ’åœ¨ è½¦ `y` åé¢ï¼Œä¸” `x` åˆ°è¾¾ç»ˆç‚¹æ‰€éœ€æ—¶é—´æ¯” `y` å°‘ï¼Œåˆ™ `x` å¿…ç„¶ä¼šè¢« `y` å¡ä½ï¼Œå½¢æˆè½¦é˜Ÿ**ã€‚

æ‰€ä»¥æœ¬é¢˜çš„æ€è·¯æ˜¯å…ˆæ ¹æ®æ¯è¾†è½¦çš„èµ·å§‹ä½ç½® `position` æ’åºï¼Œç„¶åè®¡ç®—å‡ºæ—¶é—´æ•°ç»„ `time`ã€‚

å‡è®¾è®¡ç®—å‡ºçš„ `time` æ•°ç»„ä¸º `[12, 3, 7, 1, 2]`ï¼Œé‚£ä¹ˆè§‚å¯Ÿæ•°ç»„çš„å•è°ƒæ€§å˜åŒ–ï¼Œæœ€åè‚¯å®šä¼šå½¢æˆä¸‰ä¸ªè½¦é˜Ÿï¼Œä»–ä»¬åˆ°è¾¾ç»ˆç‚¹çš„æ—¶é—´åˆ†åˆ«æ˜¯ 12, 7, 2ã€‚

å¯ä»¥åˆ©ç”¨å•è°ƒæ ˆç»“æ„æ¨¡æ‹Ÿå¾—å‡ºç»“æœï¼Œä¸è¿‡æ•ˆç‡ç¨å¾®ä½ä¸€äº›ã€‚ä¹Ÿå¯ä»¥å€’åºéå†æ•°ç»„å¾—å‡ºé€’å¢å­åºåˆ—ï¼Œå­åºåˆ—çš„é•¿åº¦å³ç­”æ¡ˆã€‚

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/)

### [è§£æ³•ä»£ç ](https://labuladong.online/algo/problem-set/monotonic-stack/#è§£æ³•ä»£ç -5)


``` PYTHON
class Solution:
    def carFleet(self, target: int, position: List[int], speed: List[int]) -> int:
        n = len(position)
        cars = []
        for i in range(n):
            cars.append([position[i], speed[i]])
        # æŒ‰ç…§åˆå§‹ä½ç½®ï¼Œä»å°åˆ°å¤§æ’åº
        cars.sort(key=lambda x: x[0])
        # è®¡ç®—æ¯è¾†è½¦åˆ°è¾¾ç»ˆç‚¹çš„æ—¶é—´
        time = []
        for i in range(n):
            car = cars[i]
            time.append((target - car[0]) / car[1])
        
        # ä½¿ç”¨å•è°ƒæ ˆè®¡ç®—è½¦é˜Ÿçš„æ•°é‡
        # (This part is commented out in the original Java code, so it's also commented out here)
        # stk = []
        # for t in time:
        #     while stk and t >= stk[-1]:
        #         stk.pop()
        #     stk.append(t)
        # return len(stk)

        # é¿å…ä½¿ç”¨æ ˆæ¨¡æ‹Ÿï¼Œå€’åºéå†å–é€’å¢åºåˆ—å°±æ˜¯ç­”æ¡ˆ
        res = 0
        max_time = 0
        for i in range(n - 1, -1, -1):
            if time[i] > max_time:
                max_time = time[i]
                res += 1
        return res
```

### [å¯è§†åŒ–](https://labuladong.online/algo/problem-set/monotonic-stack/#å¯è§†åŒ–-4)

<details data-v-ee1a9bd0="" id="div_car-fleet" class="hint-container details" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1rem 0px 0px; border-radius: 0.5rem; margin: 1.3em 0px;"><summary data-v-ee1a9bd0="" style="position: relative; margin: -1rem 0px 0px; padding-block: 1em; padding-inline: 2.3em 1.5em; list-style: none; font-size: large; cursor: pointer; display: flex; align-items: center;"><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="m4.415 18.167l7.17-7.17l1.414 1.414l-7.17 7.17z" opacity="0.3"></path><path data-v-ee1a9bd0="" fill="currentColor" d="m20 7l.94-2.06L23 4l-2.06-.94L20 1l-.94 2.06L17 4l2.06.94zM8.5 7l.94-2.06L11.5 4l-2.06-.94L8.5 1l-.94 2.06L5.5 4l2.06.94zM20 12.5l-.94 2.06l-2.06.94l2.06.94l.94 2.06l.94-2.06L23 15.5l-2.06-.94zm-2.29-3.38l-2.83-2.83c-.2-.19-.45-.29-.71-.29s-.51.1-.71.29L2.29 17.46a.996.996 0 0 0 0 1.41l2.83 2.83c.2.2.45.3.71.3s.51-.1.71-.29l11.17-11.17c.39-.39.39-1.03 0-1.42M5.83 19.59l-1.41-1.41L11.59 11L13 12.41zM14.41 11L13 9.59l1.17-1.17l1.41 1.41z"></path></svg>&nbsp;<strong data-v-ee1a9bd0="" style="font-weight: 600;">ç®—æ³•å¯è§†åŒ–é¢æ¿</strong><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="0.9em" height="0.9em" viewBox="0 0 24 24" style="margin-left: auto; margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M20 20v1h1v-1zm-4.293-5.707a1 1 0 0 0-1.414 1.414zM19 14v6h2v-6zm1 5h-6v2h6zm.707.293l-5-5l-1.414 1.414l5 5zM4 20H3v1h1zm5.707-4.293a1 1 0 0 0-1.414-1.414zM3 14v6h2v-6zm1 7h6v-2H4zm.707-.293l5-5l-1.414-1.414l-5 5zM20 4h1V3h-1zm-5.707 4.293a1 1 0 0 0 1.414 1.414zM21 10V4h-2v6zm-1-7h-6v2h6zm-.707.293l-5 5l1.414 1.414l5-5zM4 4V3H3v1zm4.293 5.707a1 1 0 0 0 1.414-1.414zM5 10V4H3v6zM4 5h6V3H4zm-.707-.293l5 5l1.414-1.414l-5-5z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" style="margin-right: 10px;"><path data-v-ee1a9bd0="" fill="currentColor" d="M17.65 6.35a7.95 7.95 0 0 0-6.48-2.31c-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20a7.98 7.98 0 0 0 7.21-4.56c.32-.67-.16-1.44-.9-1.44c-.37 0-.72.2-.88.53a5.994 5.994 0 0 1-6.8 3.31c-2.22-.49-4.01-2.3-4.48-4.52A6.002 6.002 0 0 1 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71z"></path></svg><svg data-v-ee1a9bd0="" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path data-v-ee1a9bd0="" fill="currentColor" d="M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"></path></svg></summary><div data-v-ee1a9bd0="" class="resizable" style="width: 780px; max-width: 100%; height: 70vh; min-height: 500px; overflow: hidden; resize: both;"><iframe data-v-ee1a9bd0="" title="algo-visualize panel" allow="clipboard-write; fullscreen;" id="iframe_car-fleet" src="https://labuladong.online/algo-visualize/leetcode/car-fleet/" width="100%" height="100%" loading="lazy" scrolling="auto" frameborder="0" style="overflow: auto;"></iframe></div></details>

## [581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„](https://labuladong.online/algo/problem-set/monotonic-stack/#slug_shortest-unsorted-continuous-subarray)

<details class="hint-container details" open="" style="background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.1); transition: background 0.3s ease 0s, color 0.3s ease 0s; display: block; margin-block: 0.75rem; padding: 1.25rem 1rem; border-radius: 0.5rem; color: rgb(60, 60, 67); font-family: Inter, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><summary style="position: relative; margin: -1rem -1rem 0.5em; padding-block: 1em; padding-inline: 3em 1.5em; list-style: none; font-size: 16px; cursor: pointer;"><strong style="font-weight: 600;">581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„</strong>&nbsp;|<span>&nbsp;</span><span><a href="https://leetcode.cn/problems/shortest-unsorted-continuous-subarray/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£</a><span>&nbsp;</span>|<span>&nbsp;</span></span><span><a href="https://leetcode.com/problems/shortest-unsorted-continuous-subarray/" class="" target="_blank" rel="noopener noreferrer" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">LeetCode</a><span>&nbsp;</span>|</span><span>&nbsp;</span>&nbsp;ğŸŸ </summary><div><p style="line-height: 1.6; overflow-wrap: break-word;">ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">nums</code><span>&nbsp;</span>ï¼Œä½ éœ€è¦æ‰¾å‡ºä¸€ä¸ª<span>&nbsp;</span><strong style="font-weight: 600;">è¿ç»­å­æ•°ç»„</strong><span>&nbsp;</span>ï¼Œå¦‚æœå¯¹è¿™ä¸ªå­æ•°ç»„è¿›è¡Œå‡åºæ’åºï¼Œé‚£ä¹ˆæ•´ä¸ªæ•°ç»„éƒ½ä¼šå˜ä¸ºå‡åºæ’åºã€‚</p><p style="line-height: 1.6; overflow-wrap: break-word;">è¯·ä½ æ‰¾å‡ºç¬¦åˆé¢˜æ„çš„<span>&nbsp;</span><strong style="font-weight: 600;">æœ€çŸ­</strong><span>&nbsp;</span>å­æ•°ç»„ï¼Œå¹¶è¾“å‡ºå®ƒçš„é•¿åº¦ã€‚</p><div class="original__bRMd"><div><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 1ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>nums = [2,6,4,8,10,9,15]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>5
<strong style="font-weight: 600;">è§£é‡Šï¼š</strong>ä½ åªéœ€è¦å¯¹ [6, 4, 8, 10, 9] è¿›è¡Œå‡åºæ’åºï¼Œé‚£ä¹ˆæ•´ä¸ªè¡¨éƒ½ä¼šå˜ä¸ºå‡åºæ’åºã€‚
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 2ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>nums = [1,2,3,4]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>0
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">ç¤ºä¾‹ 3ï¼š</strong></p><pre style="text-align: left; direction: ltr; white-space: pre; word-spacing: normal; word-break: normal; overflow-wrap: unset; tab-size: 4; hyphens: none; overflow: auto;"><strong style="font-weight: 600;">è¾“å…¥ï¼š</strong>nums = [1]
<strong style="font-weight: 600;">è¾“å‡ºï¼š</strong>0
</pre><p style="line-height: 1.6; overflow-wrap: break-word;"><strong style="font-weight: 600;">æç¤ºï¼š</strong></p><ul style="line-height: 1.6; overflow-wrap: break-word; padding-inline-start: 1.2em;"><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">1 &lt;= nums.length &lt;= 10<sup>4</sup></code></li><li><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">-10<sup>5</sup><span>&nbsp;</span>&lt;= nums[i] &lt;= 10<sup>5</sup></code></li></ul><p style="line-height: 1.6; overflow-wrap: break-word; margin-bottom: 0px; padding-bottom: 0px;"><strong style="font-weight: 600;">è¿›é˜¶ï¼š</strong>ä½ å¯ä»¥è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º<span>&nbsp;</span><code style="font-family: ui-monospace, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; margin: 0px; padding: 3px 6px; border-radius: 4px; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(142, 150, 170, 0.14); font-size: 0.875em; overflow-wrap: break-word; transition: background-color 0.3s, color 0.3s;">O(n)</code><span>&nbsp;</span>çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ</p></div></div></div><strong style="font-weight: 600; font-size: small;">é¢˜ç›®æ¥æºï¼š<a href="https://leetcode.cn/problems/shortest-unsorted-continuous-subarray/" class="" target="_blank" style="color: rgb(7, 86, 171); font-weight: 500; text-decoration: none; overflow-wrap: break-word;">åŠ›æ‰£ 581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„</a>ã€‚</strong></details>

### [åŸºæœ¬æ€è·¯](https://labuladong.online/algo/problem-set/monotonic-stack/#åŸºæœ¬æ€è·¯-6)

æœ€ç®€å•çš„è§£æ³•æ˜¯æ’åºï¼Œæ’åºä¹‹åå¾ˆå®¹æ˜“çœ‹å‡ºæ¥å“ªä¸€éƒ¨åˆ†å­æ•°ç»„ä¹±åºäº†ã€‚è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹å•è°ƒæ ˆçš„è§£æ³•ã€‚

å•è°ƒé€’å¢æ ˆä¼šç­›é€‰å‡ºé€’å¢çš„å…ƒç´ åºåˆ—ï¼Œæ¢å¥è¯è¯´ï¼Œæ¯åŠ å…¥ä¸€ä¸ªæ–°å…ƒç´  `x`ï¼Œå°±ä¼šå¼¹å‡ºæ ˆé¡¶å¤§äº `x` çš„å…¶ä»–å…ƒç´ ï¼Œç›´åˆ°æ ˆé¡¶å…ƒç´ å°äº `x` ä¸ºæ­¢ã€‚

åè¿‡æ¥ï¼Œå•è°ƒé€’å‡æ ˆä¼šç­›é€‰å‡ºé€’å‡çš„å…ƒç´ åºåˆ—ï¼Œæ¢å¥è¯è¯´ï¼Œæ¯åŠ å…¥ä¸€ä¸ªæ–°å…ƒç´  `x`ï¼Œå°±ä¼šå¼¹å‡ºæ ˆé¡¶å°äº `x` çš„å…¶ä»–å…ƒç´ ï¼Œç›´åˆ°æ ˆé¡¶å…ƒç´ å¤§äº `x` ä¸ºæ­¢ã€‚

ç»¼ä¸Šï¼Œå¦‚æœæ­£åºéå† `nums`ï¼Œç»´æŠ¤ä¸€ä¸ªé€’å¢æ ˆï¼Œé‚£ä¹ˆå¼¹å‡ºçš„å…ƒç´ å°±æ˜¯ä¹±åºçš„å…ƒç´ ï¼›å¦‚æœåå‘éå† `nums`ï¼Œç»´æŠ¤ä¸€ä¸ªé€’å‡æ ˆï¼Œé‚£ä¹ˆå¼¹å‡ºçš„å…ƒç´ å°±æ˜¯ä¹±åºçš„å…ƒç´ ã€‚

**è¯¦ç»†é¢˜è§£**ï¼š

- [ã€ç»ƒä¹ ã€‘å•è°ƒæ ˆçš„å‡ ç§å˜ä½“åŠç»å…¸ä¹ é¢˜](https://labuladong.online/algo/problem-set/monotonic-stack/)

### [è§£æ³•ä»£ç ](https://labuladong.online/algo/problem-set/monotonic-stack/#è§£æ³•ä»£ç -6)


``` PYTHON
# æ’åºè§£æ³•
class Solution:
    def findUnsortedSubarray(self, nums: List[int]) -> int:
        temp = sorted(nums)
        left = float('inf')
        right = float('-inf')
        for i in range(len(nums)):
            if temp[i] != nums[i]:
                left = i
                break
        for i in range(len(nums) - 1, -1, -1):
            if temp[i] != nums[i]:
                right = i
                break
        if left == float('inf') and right == float('-inf'):
            # nums æœ¬æ¥å°±æ˜¯æœ‰åºçš„
            return 0
        return right - left + 1

# å•è°ƒæ ˆè§£æ³•
class Solution2:
    def findUnsortedSubarray(self, nums: List[int]) -> int:
        n = len(nums)
        left = float('inf')
        right = float('-inf')
        # é€’å¢æ ˆï¼Œå­˜å‚¨å…ƒç´ ç´¢å¼•
        incr_stk = []
        for i in range(n):
            while incr_stk and nums[incr_stk[-1]] > nums[i]:
                # å¼¹å‡ºçš„å…ƒç´ éƒ½æ˜¯ä¹±åºå…ƒç´ ï¼Œå…¶ä¸­æœ€å°çš„ç´¢å¼•å°±æ˜¯ä¹±åºå­æ•°ç»„çš„å·¦è¾¹ç•Œ
                left = min(left, incr_stk.pop())
            incr_stk.append(i)
        # é€’å‡æ ˆï¼Œå­˜å‚¨å…ƒç´ ç´¢å¼•
        decr_stk = []
        for i in range(n - 1, -1, -1):
            while decr_stk and nums[decr_stk[-1]] < nums[i]:
                # å¼¹å‡ºçš„å…ƒç´ éƒ½æ˜¯ä¹±åºå…ƒç´ ï¼Œå…¶ä¸­æœ€å¤§çš„ç´¢å¼•å°±æ˜¯ä¹±åºå­æ•°ç»„çš„å³è¾¹ç•Œ
                right = max(right, decr_stk.pop())
            decr_stk.append(i)
        if left == float('inf') and right == float('-inf'):
            # è¯´æ˜å•è°ƒæ ˆæ²¡æœ‰å¼¹å‡ºä»»ä½•å…ƒç´ ï¼Œå³ nums æœ¬æ¥å°±æ˜¯æœ‰åºçš„
            return 0
        return right - left + 1
```
